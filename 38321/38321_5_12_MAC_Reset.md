## 5.12 MAC Reset

If a reset of the MAC entity is requested by upper layers upon receiving
*RRCResume* or *RRCSetup*, the MAC entity shall:

1\> stop the MBS multicast DRX timers;

1\> flush the soft buffers for all DL HARQ processes used for MBS
multicast;

1\> for each DL HARQ process used for MBS multicast, consider the next
received transmission for a TB as the very first transmission.

Otherwise, if a reset of the MAC entity is requested by upper layers or
the reset of the MAC entity is triggered due to SCG deactivation as
defined in clause 5.29, the MAC entity shall:

1\> if the MAC reset is not due to SCG deactivation:

2\> initialize *Bj* for each logical channel to zero;

1\> initialize *SBj* for each logical channel to zero if Sidelink
resource allocation mode 1 is configured by RRC;

1\> if upper layers indicate SCG deactivation and *bfd-and-RLM* with
value *true* is configured for the deactivated SCG:

2\> stop (if running) all timers except *beamFailureDetectionTimer*
associated with PSCell and *timeAlignmentTimer*s.

1\> else:

2\> stop (if running) all timers, except MBS broadcast DRX timers;

2\> consider all *timeAlignmentTimer*s,
*inactivePosSRS-TimeAlignmentTimer*, and *cg-SDT-TimeAlignmentTimer*, if
configured, as expired and perform the corresponding actions in clause
5.2;

1\> set the NDIs for all uplink HARQ processes to the value 0;

1\> sets the NDIs for all HARQ process IDs to the value 0 for monitoring
PDCCH in Sidelink resource allocation mode 1;

1\> stop, if any, ongoing Random Access procedure;

1\> discard explicitly signalled contention-free Random Access Resources
for 4-step RA type and 2-step RA type, if any, except the
contention-free Random Access Resources signalled in the LTM Cell Switch
Command;

1\> flush Msg3 buffer;

1\> flush MSGA buffer;

1\> cancel, if any, triggered Scheduling Request procedure;

1\> cancel, if any, triggered Buffer Status Reporting procedure;

1\> cancel, if any, triggered Delay Status Reporting procedure;

1\> cancel, if any, triggered Power Headroom Reporting procedure;

1\> cancel, if any, triggered consistent LBT failure;

1\> cancel, if any, triggered Sidelink consistent LBT failure;

1\> cancel, if any, triggered BFR;

1\> cancel, if any, triggered Sidelink Buffer Status Reporting
procedure;

1\> cancel, if any, triggered Pre-emptive Buffer Status Reporting
procedure;

1\> cancel, if any, triggered Timing Advance Reporting procedure;

1\> cancel, if any, triggered Recommended bit rate query procedure;

1\> cancel, if any, triggered Configured uplink grant confirmation;

1\> cancel, if any, triggered configured sidelink grant confirmation;

1\> clear, if any, configured sidelink grants;

1\> cancel, if any, triggered Desired Guard Symbol query;

1\> cancel, if any, triggered Positioning Measurement Gap
Activation/Deactivation Request procedure;

1\> cancel, if any, triggered SDT procedure;

1\> cancel, if any, triggered IAB-MT Recommended Beam Indication query;

1\> cancel, if any, triggered Desired DL TX Power Adjustment query;

1\> cancel, if any, triggered Desired IAB-MT PSD range query;

1\> cancel, if any, triggered Case-6 Timing Request query;

1\> cancel, if any, triggered SL-PRS resource request;

1\> flush the soft buffers for all DL HARQ processes, except for the DL
HARQ process being used for MBS broadcast;

1\> for each DL HARQ process, except for the DL HARQ process being used
for MBS broadcast, consider the next received transmission for a TB as
the very first transmission;

1\> release, if any, Temporary C-RNTI;

1\> clear, if any, Differential Koffset;

1\> if upper layers indicate SCG deactivation and *bfd-and-RLM* with
value *true* is not configured; or

1\> if the MAC reset is not due to SCG deactivation:

2\> reset all *BFI_COUNTER*s;

1\> reset all *LBT_COUNTERs*.

If a Sidelink specific reset of the MAC entity is requested for a
PC5-RRC connection by upper layers, the MAC entity shall:

1\> flush the soft buffers for all Sidelink processes for all TB(s)
associated to the PC5-RRC connection;

1\> consider all Sidelink processes for all TB(s) associated to the
PC5-RRC connection as unoccupied;

1\> cancel, if any, triggered Scheduling Request procedure only
associated to the PC5-RRC connection;

1\> cancel, if any, triggered Sidelink Buffer Status Reporting procedure
only associated to the PC5-RRC connection;

1\> cancel, if any, triggered Sidelink CSI Reporting procedure
associated to the PC5-RRC connection;

1\> cancel, if any, triggered Sidelink DRX Command Indication procedure
associated to the PC5-RRC connection;

1\> cancel, if any, triggered Sidelink IUC-Request transmission
procedure associated to the PC5-RRC connection;

1\> cancel, if any, triggered Sidelink IUC-Information Reporting
procedure associated to the PC5-RRC connection;

1\> stop (if running) all timers associated to the PC5-RRC connection;

1\> reset the *numConsecutiveDTX* associated to the PC5-RRC connection;

1\> initialize *SBj* for each logical channel associated to the PC5-RRC
connection to zero.